<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2685.1">
  <style type="text/css">
    body {background-color: #fcfaf4}
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px 'Helvetica Neue'; color: #393939; -webkit-text-stroke: #393939}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px 'Helvetica Neue'; color: #393939; -webkit-text-stroke: #393939; min-height: 15.0px}
    span.s1 {font-kerning: none}
    span.s2 {font: 12.0px 'Apple SD Gothic Neo'; font-kerning: none}
  </style>
</head>
<body>
<p class="p1"><span class="s1">&lt;!DOCTYPE html&gt;</span></p>
<p class="p1"><span class="s1">&lt;html lang="ko"&gt;</span></p>
<p class="p1"><span class="s1">&lt;head&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;meta charset="UTF-8"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;title&gt;</span><span class="s2">교회학교</span><span class="s1"> </span><span class="s2">출석</span><span class="s1"> </span><span class="s2">관리</span><span class="s1"> </span><span class="s2">시스템</span><span class="s1">&lt;/title&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;script src="https://cdn.tailwindcss.com"&gt;&lt;/script&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;script src="https://cdn.jsdelivr.net/npm/chart.js"&gt;&lt;/script&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&amp;display=swap" rel="stylesheet"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;script type="module"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>import { getAuth, signInAnonymously, onAuthStateChanged, signInWithCustomToken } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>import { getFirestore, doc, getDoc, setDoc, updateDoc, deleteDoc, onSnapshot, collection, query, where, addDoc, getDocs } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>window.firebase = {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>initializeApp,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>getAuth,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>signInAnonymously,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>onAuthStateChanged,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>getFirestore,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>doc,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>getDoc,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>setDoc,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>updateDoc,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>deleteDoc,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>onSnapshot,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>collection,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>query,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>where,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>addDoc,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>signInWithCustomToken,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>getDocs</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;/script&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;!-- Chosen Palette: Warm Harmony --&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;!-- Application Structure Plan: The application is re-architected into a multi-role SPA, offering distinct 'Teacher' and 'Administrator' experiences from a landing page. The initial screen prompts the user to select their role. The Teacher page focuses on daily, per-student attendance logging and student management (add/remove) with a new confirmation step for deletion, while the Administrator page provides high-level statistical analysis via charts. The date selection for teachers is now a dropdown of only Sundays, improving the workflow for weekly attendance tracking. A 'Main' button is added to each sub-page for improved navigation back to the role selection screen. A new feature has been added to the Teacher view, allowing for a reason to be entered when a student is marked as '</span><span class="s2">결석</span><span class="s1">', with the input field appearing dynamically and the bug related to its visibility has been fixed. All data is now persisted in Firebase Firestore to support multi-user real-time collaboration. --&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;!-- Visualization &amp; Content Choices:</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>- Daily Attendance Log (Teacher): Report Info -&gt; Daily attendance counts &amp; student list. Goal -&gt; Inform &amp; Enable data entry. Viz -&gt; Interactive student list with status buttons and add/remove functionality (HTML/Tailwind), now including a confirmation dialog for deletion. The date filter is now a dropdown of Sundays. The new feature for '</span><span class="s2">결석</span><span class="s1">' reason is implemented with a dynamically rendered input field. Interaction -&gt; Click to update status, add student via input, click a button to show the delete confirmation modal. Justification -&gt; Streamlines daily check-in process and student roster management with a crucial safety check for data integrity. The Sunday-only date filter makes the app more specific to its use case.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>- Overall Attendance Rate (Admin): Report Info -&gt; Aggregated attendance status over time. Goal -&gt; Compare. Viz -&gt; Donut Chart (Chart.js). Interaction -&gt; Filtering by class. Justification -&gt; Visualizes proportion of attendance statuses at a glance for high-level analysis.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>- Weekly Attendance Trend (Admin): Report Info -&gt; Attendance counts over several weeks. Goal -&gt; Analyze Change. Viz -&gt; Bar Chart (Chart.js). Interaction -&gt; Filtering by class. Justification -&gt; Shows trends and patterns in attendance over time.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>- CONFIRMING NO SVG/Mermaid, supporting the designed dashboard structure. --&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. --&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;style&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>body {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>font-family: 'Noto Sans KR', sans-serif;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>background-color: #FDFBF6;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>color: #4A4A4A;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.chart-container {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>position: relative;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>width: 100%;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>max-width: 600px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>margin-left: auto;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>margin-right: auto;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>height: 300px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>max-height: 400px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>@media (min-width: 768px) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>.chart-container {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>height: 350px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.modal {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>background-color: rgba(0, 0, 0, 0.5);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.profile-pic {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>width: 40px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>height: 40px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>border-radius: 50%;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>object-fit: cover;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>border: 2px solid #ccc;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.attendance-btn-present {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>background-color: #4ade80 !important;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>color: white !important;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.attendance-btn-late {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>background-color: #f97316 !important;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>color: white !important;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.attendance-btn-absent {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>background-color: #ef4444 !important;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>color: white !important;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;/style&gt;</span></p>
<p class="p1"><span class="s1">&lt;/head&gt;</span></p>
<p class="p1"><span class="s1">&lt;body&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;div id="app-container" class="container mx-auto p-4 md:p-8 max-w-7xl"&gt;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;div id="loading-view" class="h-screen flex items-center justify-center text-center"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;h2 class="text-2xl font-bold text-gray-500"&gt;</span><span class="s2">데이터를</span><span class="s1"> </span><span class="s2">불러오는</span><span class="s1"> </span><span class="s2">중입니다</span><span class="s1">...&lt;/h2&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;div id="role-selection-view" class="h-screen flex items-center justify-center text-center hidden"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;h1 class="text-5xl font-bold text-[#6a7a51] mb-8"&gt;</span><span class="s2">꿈꾸는교회</span><span class="s1"> </span><span class="s2">드림스타</span><span class="s1"> </span><span class="s2">출석</span><span class="s1"> </span><span class="s2">관리</span><span class="s1">&lt;/h1&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;p class="text-xl text-gray-600 mb-10"&gt;</span><span class="s2">드림스타</span><span class="s1"> </span><span class="s2">부서로</span><span class="s1"> </span><span class="s2">이동해주세요</span><span class="s1">&lt;/p&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;div class="flex flex-col items-center gap-4"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;button id="dream-baby-btn" class="px-8 py-4 text-lg font-medium rounded-xl shadow-lg bg-[#8D9B6A] text-white hover:bg-[#6a7a51] transition"&gt;</span><span class="s2">드림베이비</span><span class="s1">&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;button id="dream-kids-btn" class="px-8 py-4 text-lg font-medium rounded-xl shadow-lg bg-[#8D9B6A] text-white hover:bg-[#6a7a51] transition"&gt;</span><span class="s2">드림키즈</span><span class="s1">&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;button id="dream-i-btn" class="px-8 py-4 text-lg font-medium rounded-xl shadow-lg bg-[#8D9B6A] text-white hover:bg-[#6a7a51] transition"&gt;</span><span class="s2">드림아이</span><span class="s1">&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;button id="dream-teens-btn" class="px-8 py-4 text-lg font-medium rounded-xl shadow-lg bg-[#8D9B6A] text-white hover:bg-[#6a7a51] transition"&gt;</span><span class="s2">드림틴즈</span><span class="s1">&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;button id="admin-btn" class="px-8 py-4 text-lg font-medium rounded-xl shadow-lg bg-white text-gray-700 hover:bg-gray-100 transition"&gt;</span><span class="s2">관리자</span><span class="s1"> </span><span class="s2">페이지</span><span class="s1">&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;div id="teacher-view" class="hidden"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;header class="text-center mb-8 relative"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;button id="teacher-main-btn" class="absolute top-0 left-0 px-4 py-2 text-sm font-medium rounded-md shadow-sm bg-gray-500 text-white hover:bg-gray-600 transition"&gt;</span><span class="s2">메인으로</span><span class="s1">&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;h1 class="text-4xl font-bold text-[#6a7a51]"&gt;</span><span class="s2">출석</span><span class="s1"> </span><span class="s2">체크</span><span class="s1"> </span><span class="s2">페이지</span><span class="s1">&lt;/h1&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;p class="mt-2 text-lg text-gray-600"&gt;</span><span class="s2">출석여부를</span><span class="s1"> </span><span class="s2">확인하고</span><span class="s1"> </span><span class="s2">결석사유를</span><span class="s1"> </span><span class="s2">적어주세요</span><span class="s1">&lt;/p&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;/header&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;section id="teacher-controls" class="bg-white/80 backdrop-blur-sm rounded-xl shadow-md p-6 mb-8 flex flex-col md:flex-row justify-between items-center space-y-4 md:space-y-0"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;div class="flex flex-col sm:flex-row items-center space-y-4 sm:space-y-0 sm:space-x-4"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;label for="teacher-date-filter" class="block text-sm font-medium text-gray-700 mb-1"&gt;</span><span class="s2">날짜</span><span class="s1">&lt;/label&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;select id="teacher-date-filter" class="w-full sm:w-auto rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;/select&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;/section&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;section id="teacher-student-list-section"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;p class="text-gray-700 mb-4 text-center"&gt;</span><span class="s2">아래</span><span class="s1"> </span><span class="s2">학생</span><span class="s1"> </span><span class="s2">목록에서</span><span class="s1"> </span><span class="s2">출석</span><span class="s1"> </span><span class="s2">상태를</span><span class="s1"> </span><span class="s2">선택해주세요</span><span class="s1">.&lt;/p&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;div class="bg-white rounded-xl shadow-md overflow-hidden"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;table class="min-w-full divide-y divide-gray-200"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;thead class="bg-gray-50"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;tr&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"&gt;</span><span class="s2">사진</span><span class="s1">&lt;/th&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"&gt;</span><span class="s2">이름</span><span class="s1">&lt;/th&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"&gt;</span><span class="s2">부모님</span><span class="s1"> </span><span class="s2">연락처</span><span class="s1">&lt;/th&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"&gt;</span><span class="s2">생년월일</span><span class="s1">&lt;/th&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"&gt;</span><span class="s2">출결여부</span><span class="s1">&lt;/th&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"&gt;&lt;/th&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;/tr&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;/thead&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;tbody id="teacher-student-list" class="bg-white divide-y divide-gray-200"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;/tbody&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;/table&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;/section&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;div class="flex justify-center mt-8"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;button id="teacher-save-btn" class="px-6 py-2 text-sm font-medium rounded-md shadow-sm bg-green-500 text-white hover:bg-green-600"&gt;</span><span class="s2">출석</span><span class="s1"> </span><span class="s2">저장하기</span><span class="s1">&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;section id="add-student-section" class="bg-white/80 backdrop-blur-sm rounded-xl shadow-md p-6 mt-8"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;h3 class="text-lg font-semibold text-gray-700 mb-4"&gt;</span><span class="s2">학생</span><span class="s1"> </span><span class="s2">및</span><span class="s1"> </span><span class="s2">부모님</span><span class="s1"> </span><span class="s2">연락처</span><span class="s1"> </span><span class="s2">추가</span><span class="s1">&lt;/h3&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;div class="flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-2 mb-2"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;input type="text" id="new-student-name" class="flex-grow rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50" placeholder="</span><span class="s2">학생</span><span class="s1"> </span><span class="s2">이름</span><span class="s1">"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;input type="tel" id="new-parent-contact" class="flex-grow rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50" placeholder="</span><span class="s2">부모님</span><span class="s1"> </span><span class="s2">연락처</span><span class="s1"> (</span><span class="s2">예</span><span class="s1">: 010-1234-5678)"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;input type="date" id="new-student-birthdate" class="flex-grow rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;div class="flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-2 items-center"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;input type="file" id="new-student-photo" accept="image/*" class="flex-grow text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-gray-200 file:text-gray-700 hover:file:bg-gray-300"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;img id="photo-preview" class="w-12 h-12 rounded-full border border-gray-300 object-cover hidden" alt="Photo Preview"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;button id="add-student-btn" class="px-4 py-2 text-sm font-medium rounded-md shadow-sm bg-[#6a7a51] text-white hover:bg-[#8D9B6A]"&gt;</span><span class="s2">추가</span><span class="s1">&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;/section&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;div id="admin-view" class="hidden"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;header class="text-center mb-8 relative"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;button id="admin-main-btn" class="absolute top-0 left-0 px-4 py-2 text-sm font-medium rounded-md shadow-sm bg-gray-500 text-white hover:bg-gray-600 transition"&gt;</span><span class="s2">메인으로</span><span class="s1">&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;h1 class="text-4xl font-bold text-[#6a7a51]"&gt;</span><span class="s2">출석</span><span class="s1"> </span><span class="s2">통계</span><span class="s1"> </span><span class="s2">페이지</span><span class="s1">&lt;/h1&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;p class="mt-2 text-lg text-gray-600"&gt;</span><span class="s2">전체</span><span class="s1"> </span><span class="s2">출석</span><span class="s1"> </span><span class="s2">현황</span><span class="s1"> </span><span class="s2">및</span><span class="s1"> </span><span class="s2">통계를</span><span class="s1"> </span><span class="s2">확인하세요</span><span class="s1">.&lt;/p&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;/header&gt;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;section id="admin-controls" class="bg-white/80 backdrop-blur-sm rounded-xl shadow-md p-6 mb-8 flex flex-col md:flex-row justify-center items-center space-y-4 md:space-y-0 space-x-0 md:space-x-4"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                 </span>&lt;div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;label for="admin-class-filter" class="block text-sm font-medium text-gray-700 mb-1"&gt;</span><span class="s2">반</span><span class="s1"> </span><span class="s2">선택</span><span class="s1">&lt;/label&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;select id="admin-class-filter" class="w-full sm:w-auto rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;option value="</span><span class="s2">전체</span><span class="s1">"&gt;</span><span class="s2">전체</span><span class="s1">&lt;/option&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;option value="</span><span class="s2">드림베이비</span><span class="s1">"&gt;</span><span class="s2">드림베이비</span><span class="s1">&lt;/option&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;option value="</span><span class="s2">드림키즈</span><span class="s1">"&gt;</span><span class="s2">드림키즈</span><span class="s1">&lt;/option&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;option value="</span><span class="s2">드림아이</span><span class="s1">"&gt;</span><span class="s2">드림아이</span><span class="s1">&lt;/option&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;option value="</span><span class="s2">드림틴즈</span><span class="s1">"&gt;</span><span class="s2">드림틴즈</span><span class="s1">&lt;/option&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;/select&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;/section&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;section id="charts-section" class="space-y-8"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;p class="text-gray-700 mb-4 text-center"&gt;</span><span class="s2">이</span><span class="s1"> </span><span class="s2">통계</span><span class="s1"> </span><span class="s2">섹션에서는</span><span class="s1"> </span><span class="s2">장기적인</span><span class="s1"> </span><span class="s2">출석</span><span class="s1"> </span><span class="s2">데이터를</span><span class="s1"> </span><span class="s2">시각적으로</span><span class="s1"> </span><span class="s2">분석할</span><span class="s1"> </span><span class="s2">수</span><span class="s1"> </span><span class="s2">있습니다</span><span class="s1">. </span><span class="s2">출석률</span><span class="s1"> </span><span class="s2">분포</span><span class="s1"> </span><span class="s2">차트와</span><span class="s1"> </span><span class="s2">주간</span><span class="s1"> </span><span class="s2">출석</span><span class="s1"> </span><span class="s2">추이</span><span class="s1"> </span><span class="s2">차트를</span><span class="s1"> </span><span class="s2">통해</span><span class="s1"> </span><span class="s2">반</span><span class="s1"> </span><span class="s2">전체의</span><span class="s1"> </span><span class="s2">출석</span><span class="s1"> </span><span class="s2">경향과</span><span class="s1"> </span><span class="s2">패턴을</span><span class="s1"> </span><span class="s2">파악하는</span><span class="s1"> </span><span class="s2">데</span><span class="s1"> </span><span class="s2">도움을</span><span class="s1"> </span><span class="s2">줍니다</span><span class="s1">.&lt;/p&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;div class="bg-white p-6 rounded-xl shadow-md"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;h3 class="text-xl font-semibold text-center mb-4"&gt;</span><span class="s2">최근</span><span class="s1"> 4</span><span class="s2">주</span><span class="s1"> </span><span class="s2">출석률</span><span class="s1"> </span><span class="s2">분포</span><span class="s1">&lt;/h3&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;div class="chart-container"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;canvas id="attendance-pie-chart"&gt;&lt;/canvas&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;div class="bg-white p-6 rounded-xl shadow-md"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;h3 class="text-xl font-semibold text-center mb-4"&gt;</span><span class="s2">주간</span><span class="s1"> </span><span class="s2">출석</span><span class="s1"> </span><span class="s2">추이</span><span class="s1">&lt;/h3&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;div class="chart-container h-96"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;canvas id="attendance-bar-chart"&gt;&lt;/canvas&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;/section&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;div id="delete-modal" class="modal fixed inset-0 z-50 flex items-center justify-center p-4 hidden"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;div class="bg-white rounded-lg p-6 shadow-xl w-full max-w-sm"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;h3 class="text-lg font-semibold text-center mb-4"&gt;</span><span class="s2">학생</span><span class="s1"> </span><span class="s2">삭제</span><span class="s1"> </span><span class="s2">확인</span><span class="s1">&lt;/h3&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;p id="delete-modal-text" class="text-center text-gray-700 mb-6"&gt;&lt;/p&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;div class="flex justify-center space-x-4"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;button id="confirm-delete-btn" class="px-6 py-2 rounded-md font-medium text-white bg-red-600 hover:bg-red-700"&gt;</span><span class="s2">삭제</span><span class="s1">&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;button id="cancel-delete-btn" class="px-6 py-2 rounded-md font-medium text-gray-700 bg-gray-200 hover:bg-gray-300"&gt;</span><span class="s2">취소</span><span class="s1">&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;div id="password-modal" class="modal fixed inset-0 z-50 flex items-center justify-center p-4 hidden"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;div class="bg-white rounded-lg p-6 shadow-xl w-full max-w-sm"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;h3 class="text-lg font-semibold text-center mb-4"&gt;</span><span class="s2">비밀번호</span><span class="s1"> </span><span class="s2">입력</span><span class="s1">&lt;/h3&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;p class="text-center text-gray-700 mb-2"&gt;</span><span class="s2">관리자</span><span class="s1"> </span><span class="s2">페이지에</span><span class="s1"> </span><span class="s2">접속하려면</span><span class="s1"> </span><span class="s2">비밀번호를</span><span class="s1"> </span><span class="s2">입력하세요</span><span class="s1">.&lt;/p&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;input type="password" id="password-input" class="w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50 text-center mb-4"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;p id="password-error" class="text-center text-red-500 text-sm mb-4 hidden"&gt;</span><span class="s2">비밀번호가</span><span class="s1"> </span><span class="s2">올바르지</span><span class="s1"> </span><span class="s2">않습니다</span><span class="s1">.&lt;/p&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;div class="flex justify-center space-x-4"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;button id="confirm-password-btn" class="px-6 py-2 rounded-md font-medium text-white bg-green-600 hover:bg-green-700"&gt;</span><span class="s2">확인</span><span class="s1">&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;button id="cancel-password-btn" class="px-6 py-2 rounded-md font-medium text-gray-700 bg-gray-200 hover:bg-gray-300"&gt;</span><span class="s2">취소</span><span class="s1">&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;script&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const appId = typeof window.__app_id !== 'undefined' ? window.__app_id : 'default-app-id';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const firebaseConfig = typeof window.__firebase_config !== 'undefined' ? JSON.parse(window.__firebase_config) : {};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const authToken = typeof window.__initial_auth_token !== 'undefined' ? window.__initial_auth_token : null;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>let db;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>let pieChart, barChart;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>let studentToDelete = null;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const days = ['</span><span class="s2">일</span><span class="s1">', '</span><span class="s2">월</span><span class="s1">', '</span><span class="s2">화</span><span class="s1">', '</span><span class="s2">수</span><span class="s1">', '</span><span class="s2">목</span><span class="s1">', '</span><span class="s2">금</span><span class="s1">', '</span><span class="s2">토</span><span class="s1">'];</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const loadingView = document.getElementById('loading-view');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const roleSelectionView = document.getElementById('role-selection-view');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const teacherView = document.getElementById('teacher-view');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const adminView = document.getElementById('admin-view');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const adminBtn = document.getElementById('admin-btn');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const teacherMainBtn = document.getElementById('teacher-main-btn');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const adminMainBtn = document.getElementById('admin-main-btn');</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const dreamBabyBtn = document.getElementById('dream-baby-btn');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const dreamKidsBtn = document.getElementById('dream-kids-btn');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const dreamIBtn = document.getElementById('dream-i-btn');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const dreamTeensBtn = document.getElementById('dream-teens-btn');</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const teacherDateFilter = document.getElementById('teacher-date-filter');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>let teacherClassFilterValue = '';</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const teacherStudentList = document.getElementById('teacher-student-list');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const teacherSaveBtn = document.getElementById('teacher-save-btn');</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const newStudentNameInput = document.getElementById('new-student-name');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const newParentContactInput = document.getElementById('new-parent-contact');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const newStudentPhotoInput = document.getElementById('new-student-photo');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const newStudentBirthdateInput = document.getElementById('new-student-birthdate');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const photoPreview = document.getElementById('photo-preview');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const addStudentBtn = document.getElementById('add-student-btn');</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const adminClassFilter = document.getElementById('admin-class-filter');</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const deleteModal = document.getElementById('delete-modal');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const deleteModalText = document.getElementById('delete-modal-text');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const confirmDeleteBtn = document.getElementById('confirm-delete-btn');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const cancelDeleteBtn = document.getElementById('cancel-delete-btn');</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const passwordModal = document.getElementById('password-modal');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const passwordInput = document.getElementById('password-input');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const passwordError = document.getElementById('password-error');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const confirmPasswordBtn = document.getElementById('confirm-password-btn');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const cancelPasswordBtn = document.getElementById('cancel-password-btn');</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const ADMIN_PASSWORD = '0610';</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>let studentsData = {};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>let attendanceData = [];</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>async function initFirebase() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const app = firebase.initializeApp(firebaseConfig);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const auth = firebase.getAuth(app);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>db = firebase.getFirestore(app);</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (authToken) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>await firebase.signInWithCustomToken(auth, authToken);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>await firebase.signInAnonymously(auth);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>firebase.onAuthStateChanged(auth, (user) =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>loadingView.classList.add('hidden');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>roleSelectionView.classList.remove('hidden');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>setupDataListeners();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>} catch (error) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>console.error("Firebase </span><span class="s2">초기화</span><span class="s1"> </span><span class="s2">오류</span><span class="s1">:", error);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>loadingView.innerHTML = `&lt;h2 class="text-2xl font-bold text-red-500"&gt;</span><span class="s2">초기화</span><span class="s1"> </span><span class="s2">오류</span><span class="s1">: ${error.message}&lt;/h2&gt;`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>function setupDataListeners() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const studentsCollectionRef = firebase.collection(db, `artifacts/${appId}/public/data/students`);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>firebase.onSnapshot(studentsCollectionRef, (snapshot) =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const newStudentsData = {};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>snapshot.forEach(doc =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>newStudentsData[doc.id] = doc.data();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>studentsData = newStudentsData;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (!teacherView.classList.contains('hidden')) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>renderTeacherList();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const attendanceCollectionRef = firebase.collection(db, `artifacts/${appId}/public/data/attendance`);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>firebase.onSnapshot(attendanceCollectionRef, (snapshot) =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>attendanceData = snapshot.docs.map(doc =&gt; ({ id: doc.id, ...doc.data() }));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (!adminView.classList.contains('hidden')) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>renderAdminCharts();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>function populateSundayDates() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>teacherDateFilter.innerHTML = '';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const today = new Date();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const currentDay = today.getDay();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const dateList = [];</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>for (let i = -4; i &lt;= 4; i++) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const date = new Date(today);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>date.setDate(today.getDate() - currentDay + (i * 7));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>dateList.push(date);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>dateList.sort((a, b) =&gt; b - a);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>dateList.forEach(d =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const dateString = d.toISOString().split('T')[0];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const dayOfWeek = days[d.getDay()];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const option = document.createElement('option');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>option.value = dateString;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>option.textContent = `${dateString} (${dayOfWeek})`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>teacherDateFilter.appendChild(option);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>async function renderTeacherList() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const selectedDate = teacherDateFilter.value;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const selectedClass = teacherClassFilterValue;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const classData = studentsData[selectedClass] || { names: [], parentContacts: {}, photos: {}, birthdates: {} };</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const classStudents = classData.names || [];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const parentContacts = classData.parentContacts || {};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const studentPhotos = classData.photos || {};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const studentBirthdates = classData.birthdates || {};</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const attendanceMap = new Map();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>attendanceData.filter(a =&gt; a.date === selectedDate &amp;&amp; a.className === selectedClass)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                              </span>.forEach(a =&gt; attendanceMap.set(a.name, a));</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>teacherStudentList.innerHTML = '';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>classStudents.forEach(student =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const attendance = attendanceMap.get(student) || { status: '</span><span class="s2">미기입</span><span class="s1">', reason: '' };</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const contact = parentContacts[student] || '';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const photoSrc = studentPhotos[student] || 'https://placehold.co/40x40/E5E7EB/4B5563?text=N/A';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const birthdate = studentBirthdates[student] || '';</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const studentNameId = student.replace(/\s+/g, '-');</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const row = document.createElement('tr');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>row.id = `student-row-${studentNameId}`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>row.dataset.studentName = student;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>row.dataset.currentStatus = attendance.status;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const buttonHtml = getButtonHtml(attendance.status);</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>row.innerHTML = `</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;td class="px-6 py-4 whitespace-nowrap"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;img src="${photoSrc}" alt="${student} </span><span class="s2">학생</span><span class="s1"> </span><span class="s2">사진</span><span class="s1">" class="profile-pic"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;td class="px-6 py-4 whitespace-nowrap"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;div class="text-sm font-medium text-gray-900"&gt;${student}&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;td class="px-6 py-4 whitespace-nowrap"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;input type="tel" class="parent-contact-input w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50 text-sm p-1" value="${contact}"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;td class="px-6 py-4 whitespace-nowrap"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;input type="date" class="birthdate-input w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50 text-sm p-1" value="${birthdate}"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 space-x-1"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;div class="status-buttons-container"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>${buttonHtml}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;div class="flex items-center space-x-2"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                           </span>${attendance.status === '</span><span class="s2">미기입</span><span class="s1">' ? '' : `&lt;button class="change-btn px-2 py-1 text-xs rounded-md font-semibold transition bg-gray-200 text-gray-700 hover:bg-gray-300"&gt;</span><span class="s2">변경</span><span class="s1">&lt;/button&gt;`}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>teacherStudentList.appendChild(row);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const reasonRow = document.createElement('tr');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>reasonRow.id = `reason-row-${studentNameId}`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>reasonRow.innerHTML = `</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;td colspan="6" class="px-6 py-2"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;div class="reason-input-container ${attendance.status !== '</span><span class="s2">결석</span><span class="s1">' ? 'hidden' : ''}"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;input type="text" class="reason-input w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50 text-sm p-1" placeholder="</span><span class="s2">결석</span><span class="s1"> </span><span class="s2">사유를</span><span class="s1"> </span><span class="s2">입력하세요</span><span class="s1">" value="${attendance.reason}"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>teacherStudentList.appendChild(reasonRow);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>function getButtonHtml(currentStatus) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const statuses = ['</span><span class="s2">출석</span><span class="s1">', '</span><span class="s2">지각</span><span class="s1">', '</span><span class="s2">결석</span><span class="s1">'];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const colorMap = {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>'</span><span class="s2">출석</span><span class="s1">': 'bg-green-500 text-white hover:bg-green-600',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>'</span><span class="s2">지각</span><span class="s1">': 'bg-orange-500 text-white hover:bg-orange-600',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>'</span><span class="s2">결석</span><span class="s1">': 'bg-red-500 text-white hover:bg-red-600',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>'</span><span class="s2">미기입</span><span class="s1">': 'bg-gray-200 text-gray-700 hover:bg-gray-300'</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (currentStatus === '</span><span class="s2">미기입</span><span class="s1">') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>return statuses.map(s =&gt; `&lt;button class="status-btn px-2 py-1 text-xs rounded-md font-semibold transition bg-gray-200 text-gray-700 hover:bg-gray-300" data-status="${s}"&gt;${s}&lt;/button&gt;`).join(' ');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>return `&lt;button class="status-btn px-2 py-1 text-xs rounded-md font-semibold transition ${colorMap[currentStatus]}" data-status="${currentStatus}"&gt;${currentStatus}&lt;/button&gt;`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>function handleStatusChange(button) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const row = button.closest('tr');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const studentNameId = row.id.replace('student-row-', '');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const reasonRow = document.getElementById(`reason-row-${studentNameId}`);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const newStatus = button.dataset.status;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const statusButtonsContainer = row.querySelector('.status-buttons-container');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const changeBtnContainer = row.querySelector('.flex.items-center.space-x-2');</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>row.dataset.currentStatus = newStatus;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const colorMap = {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>'</span><span class="s2">출석</span><span class="s1">': 'bg-green-500 text-white',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>'</span><span class="s2">지각</span><span class="s1">': 'bg-orange-500 text-white',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>'</span><span class="s2">결석</span><span class="s1">': 'bg-red-500 text-white'</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>};</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>statusButtonsContainer.innerHTML = `&lt;button class="status-btn px-2 py-1 text-xs rounded-md font-semibold transition ${colorMap[newStatus]}" data-status="${newStatus}"&gt;${newStatus}&lt;/button&gt;`;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (newStatus === '</span><span class="s2">결석</span><span class="s1">') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>reasonRow.querySelector('.reason-input-container').classList.remove('hidden');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>reasonRow.querySelector('.reason-input-container').classList.add('hidden');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>reasonRow.querySelector('.reason-input').value = '';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (changeBtnContainer.querySelector('.change-btn') === null) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const changeBtnHtml = `&lt;button class="change-btn px-2 py-1 text-xs rounded-md font-semibold transition bg-gray-200 text-gray-700 hover:bg-gray-300"&gt;</span><span class="s2">변경</span><span class="s1">&lt;/button&gt;`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>changeBtnContainer.insertAdjacentHTML('afterbegin', changeBtnHtml);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>function handleChangeButtonClick(button) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const row = button.closest('tr');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const studentNameId = row.id.replace('student-row-', '');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const reasonRow = document.getElementById(`reason-row-${studentNameId}`);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>row.dataset.currentStatus = '</span><span class="s2">미기입</span><span class="s1">';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const statusButtonsContainer = row.querySelector('.status-buttons-container');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const changeBtnContainer = row.querySelector('.flex.items-center.space-x-2');</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const newHtml = `</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;button class="status-btn px-2 py-1 text-xs rounded-md font-semibold transition bg-gray-200 text-gray-700 hover:bg-gray-300" data-status="</span><span class="s2">출석</span><span class="s1">"&gt;</span><span class="s2">출석</span><span class="s1">&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;button class="status-btn px-2 py-1 text-xs rounded-md font-semibold transition bg-gray-200 text-gray-700 hover:bg-gray-300" data-status="</span><span class="s2">지각</span><span class="s1">"&gt;</span><span class="s2">지각</span><span class="s1">&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;button class="status-btn px-2 py-1 text-xs rounded-md font-semibold transition bg-gray-200 text-gray-700 hover:bg-gray-300" data-status="</span><span class="s2">결석</span><span class="s1">"&gt;</span><span class="s2">결석</span><span class="s1">&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>statusButtonsContainer.innerHTML = newHtml;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>reasonRow.querySelector('.reason-input-container').classList.add('hidden');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (changeBtnContainer.querySelector('.change-btn')) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>changeBtnContainer.querySelector('.change-btn').remove();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>function showDeleteConfirmation(studentName) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>studentToDelete = studentName;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>deleteModalText.textContent = `</span><span class="s2">정말</span><span class="s1"> "${studentName}" </span><span class="s2">학생을</span><span class="s1"> </span><span class="s2">명단에서</span><span class="s1"> </span><span class="s2">삭제하시겠습니까</span><span class="s1">?`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>deleteModal.classList.remove('hidden');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>function hideDeleteConfirmation() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>deleteModal.classList.add('hidden');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>studentToDelete = null;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>async function performDeletion() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const selectedClass = teacherClassFilterValue;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const studentsRef = firebase.doc(db, `artifacts/${appId}/public/data/students/${selectedClass}`);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const classData = studentsData[selectedClass] || { names: [], parentContacts: {}, photos: {}, birthdates: {} };</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const newNames = classData.names.filter(s =&gt; s !== studentToDelete);</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const newContacts = { ...classData.parentContacts };</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>delete newContacts[studentToDelete];</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const newPhotos = { ...classData.photos };</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>delete newPhotos[studentToDelete];</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const newBirthdates = { ...classData.birthdates };</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>delete newBirthdates[studentToDelete];</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>await firebase.setDoc(studentsRef, { names: newNames, parentContacts: newContacts, photos: newPhotos, birthdates: newBirthdates });</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const attendanceRef = firebase.collection(db, `artifacts/${appId}/public/data/attendance`);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const q = firebase.query(attendanceRef, firebase.where('name', '==', studentToDelete), firebase.where('className', '==', selectedClass));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const querySnapshot = await firebase.getDocs(q);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>querySnapshot.forEach(async (doc) =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>await firebase.deleteDoc(doc.ref);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>hideDeleteConfirmation();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>} catch (e) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>console.error("</span><span class="s2">학생</span><span class="s1"> </span><span class="s2">삭제</span><span class="s1"> </span><span class="s2">오류</span><span class="s1">:", e);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>async function addStudent() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const newStudentName = newStudentNameInput.value.trim();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const newParentContact = newParentContactInput.value.trim();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const photoFile = newStudentPhotoInput.files[0];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const newStudentBirthdate = newStudentBirthdateInput.value.trim();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const selectedClass = teacherClassFilterValue;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (!newStudentName || (studentsData[selectedClass] &amp;&amp; studentsData[selectedClass].names.includes(newStudentName))) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>return;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>let photoData = null;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (photoFile) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (photoFile.size &gt; 100000) { // 100KB limit</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>alert('</span><span class="s2">사진</span><span class="s1"> </span><span class="s2">크기가</span><span class="s1"> </span><span class="s2">너무</span><span class="s1"> </span><span class="s2">큽니다</span><span class="s1">. 100KB </span><span class="s2">이하의</span><span class="s1"> </span><span class="s2">파일을</span><span class="s1"> </span><span class="s2">업로드해주세요</span><span class="s1">.');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>return;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>photoData = await new Promise((resolve) =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>const reader = new FileReader();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>reader.onloadend = () =&gt; resolve(reader.result);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>reader.readAsDataURL(photoFile);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const studentsRef = firebase.doc(db, `artifacts/${appId}/public/data/students/${selectedClass}`);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const classData = studentsData[selectedClass] || { names: [], parentContacts: {}, photos: {}, birthdates: {} };</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const newNames = [...(classData.names || []), newStudentName];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const newContacts = { ...(classData.parentContacts || {}), [newStudentName]: newParentContact };</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const newPhotos = { ...(classData.photos || {}), [newStudentName]: photoData };</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const newBirthdates = { ...(classData.birthdates || {}), [newStudentName]: newStudentBirthdate };</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>await firebase.setDoc(studentsRef, { names: newNames, parentContacts: newContacts, photos: newPhotos, birthdates: newBirthdates });</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>newStudentNameInput.value = '';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>newParentContactInput.value = '';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>newStudentPhotoInput.value = '';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>newStudentBirthdateInput.value = '';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>photoPreview.classList.add('hidden');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>} catch (e) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>console.error("</span><span class="s2">학생</span><span class="s1"> </span><span class="s2">추가</span><span class="s1"> </span><span class="s2">오류</span><span class="s1">:", e);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>async function saveAttendance() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const selectedDate = teacherDateFilter.value;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const selectedClass = teacherClassFilterValue;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const rows = teacherStudentList.querySelectorAll('tr');</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const classData = studentsData[selectedClass] || { names: [], parentContacts: {}, photos: [], birthdates: {} };</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const updatedParentContacts = { ...classData.parentContacts };</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const updatedBirthdates = { ...classData.birthdates };</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const updatedNames = [...classData.names];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const updatedPhotos = {...classData.photos};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>for (let i = 0; i &lt; rows.length; i += 2) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const row = rows[i];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const reasonRow = rows[i+1];</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const studentName = row.dataset.studentName;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const newStatus = row.dataset.currentStatus;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const newContact = row.querySelector('.parent-contact-input').value;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const newBirthdate = row.querySelector('.birthdate-input').value;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const reason = newStatus === '</span><span class="s2">결석</span><span class="s1">' ? reasonRow.querySelector('.reason-input').value : '';</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>updatedParentContacts[studentName] = newContact;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>updatedBirthdates[studentName] = newBirthdate;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const existingEntry = attendanceData.find(a =&gt; a.date === selectedDate &amp;&amp; a.className === selectedClass &amp;&amp; a.name === studentName);</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>if (existingEntry) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>const attendanceRef = firebase.doc(db, `artifacts/${appId}/public/data/attendance/${existingEntry.id}`);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>await firebase.updateDoc(attendanceRef, { status: newStatus, reason: reason });</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>const attendanceRef = firebase.collection(db, `artifacts/${appId}/public/data/attendance`);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>await firebase.addDoc(attendanceRef, {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>date: selectedDate,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>className: selectedClass,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>name: studentName,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>status: newStatus,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>reason: reason</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>} catch (e) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>console.error("</span><span class="s2">출석</span><span class="s1"> </span><span class="s2">저장</span><span class="s1"> </span><span class="s2">오류</span><span class="s1">:", e);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const studentsRef = firebase.doc(db, `artifacts/${appId}/public/data/students/${selectedClass}`);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>await firebase.setDoc(studentsRef, { names: updatedNames, parentContacts: updatedParentContacts, photos: updatedPhotos, birthdates: updatedBirthdates });</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>newStudentPhotoInput.addEventListener('change', () =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const file = newStudentPhotoInput.files[0];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (file) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const reader = new FileReader();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>reader.onload = (e) =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>photoPreview.src = e.target.result;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>photoPreview.classList.remove('hidden');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>reader.readAsDataURL(file);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>photoPreview.classList.add('hidden');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>function renderAdminCharts() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const selectedClass = adminClassFilter.value;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const today = new Date();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const fourWeeksAgo = new Date(today);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>fourWeeksAgo.setDate(today.getDate() - 28);</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>let recentAttendance;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (selectedClass === '</span><span class="s2">전체</span><span class="s1">') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>recentAttendance = attendanceData.filter(a =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>const aDate = new Date(a.date);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>return aDate &gt;= fourWeeksAgo &amp;&amp; aDate &lt;= today;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>recentAttendance = attendanceData.filter(a =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>const aDate = new Date(a.date);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>return a.className === selectedClass &amp;&amp; aDate &gt;= fourWeeksAgo &amp;&amp; aDate &lt;= today;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const statusCounts = { '</span><span class="s2">출석</span><span class="s1">': 0, '</span><span class="s2">지각</span><span class="s1">': 0, '</span><span class="s2">결석</span><span class="s1">': 0 };</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>recentAttendance.forEach(a =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (statusCounts[a.status] !== undefined) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>statusCounts[a.status]++;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>});</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>renderPieChart(statusCounts);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>renderBarChart(selectedClass);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>function renderPieChart(statusCounts) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const ctx = document.getElementById('attendance-pie-chart').getContext('2d');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (pieChart) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>pieChart.destroy();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>pieChart = new Chart(ctx, {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>type: 'doughnut',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>data: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>labels: ['</span><span class="s2">출석</span><span class="s1">', '</span><span class="s2">지각</span><span class="s1">', '</span><span class="s2">결석</span><span class="s1">'],</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>datasets: [{</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>data: [statusCounts['</span><span class="s2">출석</span><span class="s1">'], statusCounts['</span><span class="s2">지각</span><span class="s1">'], statusCounts['</span><span class="s2">결석</span><span class="s1">']],</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>backgroundColor: ['#4ade80', '#f97316', '#ef4444'],</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>borderColor: '#FDFBF6',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>borderWidth: 4</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>}]</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>},</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>options: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>responsive: true,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>maintainAspectRatio: false,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>plugins: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>legend: { position: 'bottom' }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>function renderBarChart(selectedClass) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const today = new Date();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const labels = [];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const datasets = [</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>{ label: '</span><span class="s2">출석</span><span class="s1">', data: [], backgroundColor: '#4ade80' },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>{ label: '</span><span class="s2">지각</span><span class="s1">', data: [], backgroundColor: '#f97316' },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>{ label: '</span><span class="s2">결석</span><span class="s1">', data: [], backgroundColor: '#ef4444' },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>];</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>for (let i = 3; i &gt;= 0; i--) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const weekStart = new Date(today);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>weekStart.setDate(today.getDate() - (i * 7) - today.getDay());</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const weekEnd = new Date(weekStart);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>weekEnd.setDate(weekStart.getDate() + 6);</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>labels.push(`${weekStart.getMonth()+1}/${weekEnd.getDate()} (${days[weekEnd.getDay()]})`);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>let weekAttendance;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (selectedClass === '</span><span class="s2">전체</span><span class="s1">') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>weekAttendance = attendanceData.filter(a =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>const aDate = new Date(a.date);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>return aDate &gt;= weekStart &amp;&amp; aDate &lt;= weekEnd;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>weekAttendance = attendanceData.filter(a =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>const aDate = new Date(a.date);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>return a.className === selectedClass &amp;&amp; aDate &gt;= weekStart &amp;&amp; aDate &lt;= weekEnd;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>datasets[0].data.push(weekAttendance.filter(a =&gt; a.status === '</span><span class="s2">출석</span><span class="s1">').length);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>datasets[1].data.push(weekAttendance.filter(a =&gt; a.status === '</span><span class="s2">지각</span><span class="s1">').length);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>datasets[2].data.push(weekAttendance.filter(a =&gt; a.status === '</span><span class="s2">결석</span><span class="s1">').length);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const ctx = document.getElementById('attendance-bar-chart').getContext('2d');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (barChart) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>barChart.destroy();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>barChart = new Chart(ctx, {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>type: 'bar',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>data: { labels, datasets },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>options: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>responsive: true,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>maintainAspectRatio: false,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>scales: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>x: { stacked: true },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>y: { stacked: true, beginAtZero: true }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>},</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>plugins: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>legend: { position: 'bottom' }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>function showView(view) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>loadingView.classList.add('hidden');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>roleSelectionView.classList.add('hidden');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>teacherView.classList.add('hidden');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>adminView.classList.add('hidden');</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (view === 'teacher') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>teacherView.classList.remove('hidden');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>populateSundayDates();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>renderTeacherList();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>} else if (view === 'admin') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>adminView.classList.remove('hidden');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>renderAdminCharts();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>} else if (view === 'main') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>roleSelectionView.classList.remove('hidden');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>dreamBabyBtn.addEventListener('click', () =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>teacherClassFilterValue = '</span><span class="s2">드림베이비</span><span class="s1">';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>showView('teacher');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>dreamKidsBtn.addEventListener('click', () =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>teacherClassFilterValue = '</span><span class="s2">드림키즈</span><span class="s1">';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>showView('teacher');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>dreamIBtn.addEventListener('click', () =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>teacherClassFilterValue = '</span><span class="s2">드림아이</span><span class="s1">';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>showView('teacher');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>dreamTeensBtn.addEventListener('click', () =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>teacherClassFilterValue = '</span><span class="s2">드림틴즈</span><span class="s1">';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>showView('teacher');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>adminBtn.addEventListener('click', () =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>passwordModal.classList.remove('hidden');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>passwordInput.focus();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>teacherMainBtn.addEventListener('click', () =&gt; showView('main'));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>adminMainBtn.addEventListener('click', () =&gt; showView('main'));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>teacherDateFilter.addEventListener('change', renderTeacherList);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>teacherSaveBtn.addEventListener('click', saveAttendance);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>addStudentBtn.addEventListener('click', addStudent);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>adminClassFilter.addEventListener('change', renderAdminCharts);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>confirmDeleteBtn.addEventListener('click', performDeletion);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>cancelDeleteBtn.addEventListener('click', hideDeleteConfirmation);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>confirmPasswordBtn.addEventListener('click', () =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (passwordInput.value === ADMIN_PASSWORD) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>passwordModal.classList.add('hidden');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>passwordError.classList.add('hidden');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>passwordInput.value = '';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>showView('admin');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>passwordError.classList.remove('hidden');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>passwordInput.value = '';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>passwordInput.focus();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>cancelPasswordBtn.addEventListener('click', () =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>passwordModal.classList.add('hidden');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>passwordError.classList.add('hidden');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>passwordInput.value = '';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>teacherStudentList.addEventListener('click', (e) =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const statusBtn = e.target.closest('.status-btn');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const changeBtn = e.target.closest('.change-btn');</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (statusBtn) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>handleStatusChange(statusBtn);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>} else if (changeBtn) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>handleChangeButtonClick(changeBtn);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>window.onload = initFirebase;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;/script&gt;</span></p>
<p class="p1"><span class="s1">&lt;/body&gt;</span></p>
<p class="p1"><span class="s1">&lt;/html&gt;</span></p>
</body>
</html>
